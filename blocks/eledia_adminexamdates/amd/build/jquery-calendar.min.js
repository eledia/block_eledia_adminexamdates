/*
 * @class Calendar ~jquery-calendar plugin~ (https://github.com/ArrobeFr/jquery-calendar-bs4)
 * @author Developped by Arrobe (https://www.arrobe.fr)
 * Some Improvements, refactorizations and fixes: M. A. Coma Rivas
 * @license Licensed under MIT (https://github.com/ArrobeFr/jquery-calendar/blob/master/LICENSE)
 */
jQuery(document).ready((function($){function Calendar(element,Args){if("function"==typeof moment){var eventColors=["#C62828","#AD1457","#6A1B9A","#4527A0","#283593","#1565C0","#0277BD","#00838F","#00695C","#2E7D32","#558B2F","#9E9D24","#F9A825","#FF8F00","#EF6C00","#D84315","#4E342E","#424242","#37474F","#212121"],daynoteColors=["#EF9A9A","#F48FB1","#CE93D8","#B39DDB","#9FA8DA","#90CAF9","#81D4FA","#80DEEA","#80CBC4","#A5D6A7","#C5E1A5","#E6EE9C","#FFF59D","#FFE082","#FFCC80","#FFAB91","#BCAAA4","#EEEEEE","#B0BEC5"];this.conf={locale:Args.locale?Args.locale:"fr",view:"week",rooms:!1!==Args.rooms&&Args.rooms,enableKeyboard:!Args.enableKeyboard||Args.enableKeyboard,defaultView:{largeScreen:Args.defaultView&&Args.defaultView.largeScreen?Args.defaultView.largeScreen:"week",smallScreen:Args.defaultView&&Args.defaultView.smallScreen?Args.defaultView.smallScreen:"day",smallScreenThreshold:Args.defaultView&&Args.defaultView.smallScreenThreshold?Args.defaultView.smallScreenThreshold:1e3},weekday:{timeline:{fromHour:Args.weekday&&Args.weekday.timeline&&Args.weekday.timeline.fromHour?Args.weekday.timeline.fromHour:7,toHour:Args.weekday&&Args.weekday.timeline&&Args.weekday.timeline.toHour?Args.weekday.timeline.toHour:20,intervalMinutes:Args.weekday&&Args.weekday.timeline&&Args.weekday.timeline.intervalMinutes?Args.weekday.timeline.intervalMinutes:60,format:Args.weekday&&Args.weekday.timeline&&Args.weekday.timeline.format?Args.weekday.timeline.format:"HH:mm",heightPx:Args.weekday&&Args.weekday.timeline&&Args.weekday.timeline.heightPx?Args.weekday.timeline.heightPx:50,autoResize:!Args.weekday||(!Args.weekday.timeline||(void 0===Args.weekday.timeline.autoResize||Args.weekday.timeline.autoResize))},dayline:{weekdays:Args.weekday&&Args.weekday.dayline&&Args.weekday.dayline.weekdays?Args.weekday.dayline.weekdays:[0,1,2,3,4,5,6],format:Args.weekday&&Args.weekday.dayline&&Args.weekday.dayline.format?Args.weekday.dayline.format:"dddd DD/MM",heightPx:Args.weekday&&Args.weekday.dayline&&Args.weekday.dayline.heightPx&&Args.weekday.dayline.heightPx&&Args.weekday.dayline.heightPx>31?Args.weekday.dayline.heightPx:31,month:{format:Args.weekday&&Args.weekday.dayline&&Args.weekday.dayline.month&&Args.weekday.dayline.month.format?Args.weekday.dayline.month.format:"MMMM YYYY",heightPx:Args.weekday&&Args.weekday.dayline&&Args.weekday.dayline.month&&Args.weekday.dayline.month.heightPx?Args.weekday.dayline.month.heightPx:30,weekFormat:Args.weekday&&Args.weekday.dayline&&Args.weekday.dayline.month&&Args.weekday.dayline.month.weekFormat?Args.weekday.dayline.month.weekFormat:"w"}}},month:{format:Args.month&&Args.month.format?Args.month.format:"MMMM YYYY",heightPx:Args.month&&Args.month.heightPx&&Args.month.heightPx>31?Args.month.heightPx:31,weekline:{format:Args.month&&Args.month.weekline&&Args.month.weekline.format?Args.month.weekline.format:"w",heightPx:Args.month&&Args.month.weekline&&Args.month.weekline.heightPx?Args.month.weekline.heightPx:80},dayheader:{weekdays:Args.month&&Args.month.dayheader&&Args.month.dayheader.weekdays?Args.month.dayheader.weekdays:[0,1,2,3,4,5,6],format:Args.month&&Args.month.dayheader&&Args.month.dayheader.format?Args.month.dayheader.format:"dddd",heightPx:Args.month&&Args.month.dayheader&&Args.month.dayheader.heightPx?Args.month.dayheader.heightPx:30},day:{format:Args.month&&Args.month.day&&Args.month.day.format?Args.month.day.format:"DD/MM"}},unixTimestamp:Args.unixTimestamp?Args.unixTimestamp:moment().format("X"),event:{hover:{delay:Args.event&&Args.event.hover&&Args.event.hover.delay?Args.event.hover.delay:500}},colors:{events:Args.colors&&Args.colors.events?Args.colors.events:eventColors,daynotes:Args.colors&&Args.colors.daynotes?Args.colors.daynotes:daynoteColors,random:!Args.colors||(!Args.colors.random||Args.colors.random)},categories:{enable:!Args.categories||(void 0===Args.categories.enable||Args.categories.enable),hover:{delay:Args.categories&&Args.categories.hover&&Args.categories.hover.delay?Args.categories.hover.delay:500}},now:{enable:!!Args.now&&(void 0!==Args.now.enable&&Args.now.enable),refresh:!!Args.now&&(void 0!==Args.now.refresh&&Args.now.refresh),heightPx:Args.now&&Args.now.heightPx?Args.now.heightPx:1,style:Args.now&&Args.now.style?Args.now.style:"solid",color:Args.now&&Args.now.color?Args.now.color:"#03A9F4"}},moment.locale(this.conf.locale),this.setEventColors(this.conf.colors.events),this.setDaynoteColors(this.conf.colors.daynotes),this.eventCategoryColor=[],this.daynoteCategoryColor=[],this.userEventCategoryColor=[],this.userDaynoteCategoryColor=[],this.setEvents(Args.events?Args.events:[]),this.setDaynotes(Args.daynotes?Args.daynotes:[]),"mobile"==this.mobileQuery()?this.setView(this.conf.defaultView.smallScreen):this.setView(this.conf.defaultView.largeScreen),this.element=element,this.initTime=!1}else console.error("Calendar require Moment.js !")}Calendar.prototype.init=function(){var millis=Date.now();this.element.addClass("loading"),this.calculateCurrentInterval(),$(this.element).trigger("Calendar.init",[this,this.getPrevViewInterval(),this.getViewInterval(),this.getNextViewInterval()]),$(this.element).html(""),$(this.element).hasClass("calendar")||$(this.element).addClass("calendar"),"day"!=this.getView()&&"week"!=this.getView()||this.conf.weekday.timeline.autoResize&&this.resizeTimeline(),this.drawCategories(),"day"!=this.getView()&&"week"!=this.getView()||(this.weekDrawTime(),this.weekDrawDays(),this.weekDrawDaynotes(),this.weekDrawEvents()),"month"==this.getView()&&(this.monthDrawWeek(),this.monthDrawWeekNumbers(),this.monthDrawWeekDays(),this.monthDrawDaynotes(),this.monthDrawEvents()),this.drawModal(),this.drawNow(),this.positionEvents(),this.hoverEventOrDaynote(),this.clickEventOrDaynote(),this.addBtnLeftRight(),this.addSwipe(),this.clickSwitchView(),this.keyboardSwitchView(),this.defaultEvents(),this.element.removeClass("loading"),this.initTime=Date.now()-millis+"ms"},Calendar.prototype.defaultEvents=function(){if(1!=this.binded){var eventMouseenterDefault=function(event,self,elem){if(!event.isDefaultPrevented()){if(parseInt(elem.css("top"))>=elem.closest("ul").height()/2-self.conf.weekday.timeline.heightPx){var heightPx=parseInt(elem.css("top"))+parseInt(elem.css("height"));elem.css("z-index",10).animate({height:heightPx,top:0,width:"100%",left:0},50)}else{heightPx=elem.closest("ul").height()-parseInt(elem.css("top"));elem.css("z-index",10).animate({height:heightPx,width:"100%",left:0},50)}elem.find(".event-name").removeClass("invisible"),elem.find(".event-content").removeClass("invisible")}};$(this.element).off("Calendar.event-mouseenter",eventMouseenterDefault).on("Calendar.event-mouseenter",eventMouseenterDefault),$(this.element).off("Calendar.daynote-mouseenter",eventMouseenterDefault).on("Calendar.daynote-mouseenter",eventMouseenterDefault);var eventMouseleaveDefault=function(event,self,elem){event.isDefaultPrevented()||(elem.css("z-index","auto").animate({height:parseFloat(elem.attr("data-height"))+"px",top:parseFloat(elem.attr("data-top")),width:parseFloat(elem.attr("data-width"))+"%",left:parseFloat(elem.attr("data-left"))+"%"},50),elem.find(".event-content").addClass("invisible"))};$(this.element).off("Calendar.event-mouseleave",eventMouseleaveDefault).on("Calendar.event-mouseleave",eventMouseleaveDefault),$(this.element).off("Calendar.daynote-mouseleave",eventMouseleaveDefault).on("Calendar.daynote-mouseleave",eventMouseleaveDefault);var eventClickDefault=function(event,self,elem,evt){if(!event.isDefaultPrevented()){var modal=$(self.element).find("#calendar-modal"),rgb=self.hexToRgb(elem.attr("data-color"));modal.css("background","rgba("+rgb.r+", "+rgb.g+", "+rgb.b+", 0.5)"),modal.find(".modal-title").append(elem.attr("data-title")+" "),modal.find(".modal-body").append($("<h4>").append($(this).closest(".calendar-events-day").find("span").html()).append(" ").append($("<small>").text(elem.find(".event-date").text()))),modal.find(".modal-body").append(elem.find(".event-content").html()),modal.modal("show"),modal.on("hidden.bs.modal",(function(e){$(e.target).find(".modal-title").html(""),$(e.target).find(".modal-body").html("")}))}};$(this.element).off("Calendar.event-click",eventClickDefault).on("Calendar.event-click",eventClickDefault),$(this.element).off("Calendar.daynote-click",eventClickDefault).on("Calendar.daynote-click",eventClickDefault);var eventCategoryClickDefault=function(event,self,elem){if(!event.isDefaultPrevented()){var events=self.element.find('.calendar-event[data-category="'+$(elem).text()+'"]');"false"==$(elem).attr("data-clicked")&&events.animate({opacity:0},200,(function(){events.css("display","none"),$(elem).css("background-color","#E0E0E0"),$(elem).attr("data-clicked",!0)})),"true"==$(elem).attr("data-clicked")&&(events.css("display","list-item"),$(elem).css("background-color",$(elem).attr("data-color")),events.animate({opacity:1},200,(function(){$(elem).attr("data-clicked",!1)})))}};$(this.element).off("Calendar.category-event-click",eventCategoryClickDefault).on("Calendar.category-event-click",eventCategoryClickDefault),$(this.element).off("Calendar.category-daynote-click",eventCategoryClickDefault).on("Calendar.category-daynote-click",eventCategoryClickDefault);var eventCategoryMouseenterDefault=function(event,self,elem){event.isDefaultPrevented()||self.element.find(".calendar-event").each((function(i,e){$(e).attr("data-category")!=elem.text()&&$(e).css("opacity",.2)}))};$(this.element).off("Calendar.category-event-mouseenter",eventCategoryMouseenterDefault).on("Calendar.category-event-mouseenter",eventCategoryMouseenterDefault),$(this.element).off("Calendar.category-daynote-mouseenter",eventCategoryMouseenterDefault).on("Calendar.category-daynote-mouseenter",eventCategoryMouseenterDefault);var eventCategoryMouseleaveDefault=function(event,self,elem){event.isDefaultPrevented()||self.element.find(".calendar-event").each((function(i,e){$(e).css("opacity",1)}))};$(this.element).off("Calendar.category-event-mouseleave",eventCategoryMouseleaveDefault).on("Calendar.category-event-mouseleave",eventCategoryMouseleaveDefault),$(this.element).off("Calendar.category-daynote-mouseleave",eventCategoryMouseleaveDefault).on("Calendar.category-daynote-mouseleave",eventCategoryMouseleaveDefault),this.binded=!0}},Calendar.prototype.weekDrawTime=function(){$(this.element).append($("<div>",{class:"calendar-timeline"})),$(this.element).find("div.calendar-timeline").css("padding-top",this.conf.weekday.dayline.heightPx+"px");var marginTop=this.conf.weekday.dayline.month.heightPx;if(this.conf.categories.enable){var $categoryBar=$(this.element).find("div.calendar-categories");marginTop+=$categoryBar.height()+parseFloat($categoryBar.css("margin-bottom"))}$(this.element).find("div.calendar-timeline").css("margin-top",marginTop+"px"),$(this.element).find("div.calendar-timeline").append($("<ul>"));var li,ul=$(this.element).find("div.calendar-timeline").find("ul"),time=moment(moment()).startOf("Week");time.add(this.conf.weekday.timeline.fromHour,"H");for(var limit=(60*(this.conf.weekday.timeline.toHour+1)-60*this.conf.weekday.timeline.fromHour)/this.conf.weekday.timeline.intervalMinutes,i=0;i<limit;)(li=$("<li>")).append($("<span>").text(time.format(this.conf.weekday.timeline.format))),li.height(this.conf.weekday.timeline.heightPx),ul.append(li),time.add(this.conf.weekday.timeline.intervalMinutes,"m"),i++},Calendar.prototype.weekDrawDays=function(){$(this.element).append($("<div>",{class:"calendar-events"}));var div=$("<div>",{class:"calendar-month"}).css("height",this.conf.weekday.dayline.month.heightPx+"px").css("text-align","center").css("padding-top",(this.conf.weekday.dayline.month.heightPx-20)/2+"px");"week"==this.getView()&&(div.text(this.miscUcfirstString(moment.unix(this.conf.unixTimestamp).format(this.conf.weekday.dayline.month.format))),div.addClass("weektomonth")),"day"==this.getView()&&(div.text(this.miscUcfirstString(moment.unix(this.conf.unixTimestamp).format(this.conf.weekday.dayline.month.weekFormat))),div.addClass("daytoweek")),$(this.element).find("div.calendar-events").append(div),$(this.element).find("div.calendar-events").append($("<ul>"));for(var li,ul=$(this.element).find("div.calendar-events").find("ul"),days=this.getViewDays(),i=0;i<days.length;i++)time=moment.unix(days[i]),(li=$("<li>",{class:"calendar-events-day"})).css("width",100/days.length+"%"),(div=$("<div>",{class:"calendar-day-header"})).height(this.conf.weekday.dayline.heightPx),0==i&&"desktop"==this.mobileQuery()&&div.append($("<button>",{class:"btn btn-sm btn-light btn-move-calendar"}).attr("data-direction","left").append($("<i>",{class:"fas fa-arrow-left"}))),div.append($("<span>").addClass("weektoday").css("width","100%").html(this.miscUcfirstString(time.format(this.conf.weekday.dayline.format)))),i==days.length-1&&"desktop"==this.mobileQuery()&&div.append($("<button>",{class:"btn btn-sm btn-light btn-move-calendar"}).attr("data-direction","right").append($("<i>",{class:"fas fa-arrow-right"}))),li.append(div),li.attr("data-time",time.startOf("day").format("X")),li.append($("<ul>")),li.find("ul").height(60/this.conf.weekday.timeline.intervalMinutes*(this.conf.weekday.timeline.toHour-this.conf.weekday.timeline.fromHour)*this.conf.weekday.timeline.heightPx+60/this.conf.weekday.timeline.intervalMinutes*this.conf.weekday.timeline.heightPx),ul.append(li);var maxHeight=0;$(this.element).find(".calendar-day-header").each((function(){$(this).height()>maxHeight&&(maxHeight=$(this).height())})),$(this.element).find(".calendar-day-header").each((function(){$(this).height(maxHeight)})),this.conf.weekday.dayline.heightPx<maxHeight&&(this.conf.weekday.dayline.heightPx=maxHeight,$(this.element).find("div.calendar-timeline").css("padding-top",this.conf.weekday.dayline.heightPx+"px"))},Calendar.prototype.monthDrawWeek=function(){$(this.element).append($("<div>",{class:"calendar-events"}));var div=$("<div>",{class:"calendar-month"});div.css("height",this.conf.month.heightPx+"px"),"desktop"==this.mobileQuery()&&div.append($("<button>",{class:"btn btn-sm btn-light btn-move-calendar"}).attr("data-direction","left").append($("<i>",{class:"fas fa-angle-left"}))),div.append($("<span>").css("position","absolute").css("top",this.conf.month.heightPx/2+"px").css("right","50%").css("transform","translate(50%,-50%)").text(this.miscUcfirstString(moment.unix(this.conf.unixTimestamp).format(this.conf.month.format)))),"desktop"==this.mobileQuery()&&div.append($("<button>",{class:"btn btn-sm btn-light btn-move-calendar"}).css("float","right").attr("data-direction","right").append($("<i>",{class:"fas fa-arrow-right"}))),$(this.element).find("div.calendar-events").append(div),$(this.element).find("div.calendar-events").append($("<ul>"));for(var li,ul=$(this.element).find("div.calendar-events").find("ul"),time=moment.unix(this.conf.unixTimestamp).startOf("month"),month=parseInt(time.format("MM")),week=parseInt(time.format("w")),nbWeeks=0;parseInt(time.format("MM"))==month;){for(nbWeeks++;parseInt(time.format("w"))==week;)time.add(1,"days");week=parseInt(time.format("w"))}for(var i=0;i<this.conf.month.dayheader.weekdays.length;i++)time=moment().startOf("week").add(this.conf.month.dayheader.weekdays[i],"days"),(li=$("<li>",{class:"calendar-month-day-header"})).append($("<div>").css("height",this.conf.month.dayheader.heightPx+"px").css("padding-top",(this.conf.month.dayheader.heightPx-20)/2+"px").text(this.miscUcfirstString(time.format(this.conf.month.dayheader.format)))),li.css("width",100/this.conf.month.dayheader.weekdays.length+"%"),li.append($("<ul>").css("height",nbWeeks*this.conf.month.weekline.heightPx+"px")),ul.append(li);var maxHeight=0;$(this.element).find(".calendar-month-day-header").each((function(){var e=$(this).find("div");$(e).height()>maxHeight&&(maxHeight=$(e).height())})),$(this.element).find(".calendar-month-day-header").each((function(){var e=$(this).find("div");$(e).height(maxHeight)}))},Calendar.prototype.monthDrawWeekNumbers=function(){$(this.element).append($("<div>",{class:"calendar-timeline"}));var marginTop=this.conf.month.dayheader.heightPx;marginTop+=this.conf.month.heightPx,this.conf.categories.enable&&(marginTop+=30),marginTop+=2,$(this.element).find("div.calendar-timeline").css("margin-top",marginTop+"px"),$(this.element).find("div.calendar-timeline").append($("<ul>"));for(var li,ul=$(this.element).find("div.calendar-timeline").find("ul"),time=moment.unix(this.conf.unixTimestamp).startOf("month"),month=parseInt(time.format("MM")),week=parseInt(time.format("w"));parseInt(time.format("MM"))==month;){for((li=$("<li>",{class:"monthtoweek"})).append($("<span>").attr("data-timestamp",time.format("X")).text(time.format(this.conf.month.weekline.format)).css("margin-top",this.conf.month.weekline.heightPx/2+"px")),li.height(this.conf.month.weekline.heightPx),ul.append(li);parseInt(time.format("w"))==week;)time.add(1,"days");week=parseInt(time.format("w"))}},Calendar.prototype.monthDrawWeekDays=function(){for(var targetUl,li,days=this.getViewDays(),i=parseInt(moment.unix(days[0]).weekday()),time=moment.unix(days[0]);i>0;)time=time.subtract(1,"days"),targetUl=this.element.find(".calendar-events>ul>.calendar-month-day-header>div:contains('"+this.miscUcfirstString(time.format(this.conf.month.dayheader.format))+"')").parent().find("ul"),(li=$("<li>")).css("height",this.conf.month.weekline.heightPx+"px"),$(targetUl).append(li),i--;for(time=days.length,i=0;i<time;i++)targetUl=this.element.find(".calendar-events>ul>.calendar-month-day-header>div:contains('"+this.miscUcfirstString(moment.unix(days[i]).format(this.conf.month.dayheader.format))+"')").parent().find("ul"),(li=$("<li>",{class:"calendar-month-events-day"})).css("height",this.conf.month.weekline.heightPx+"px"),li.attr("data-time-from",moment.unix(days[i]).startOf("day").format("X")),li.attr("data-time-to",moment.unix(days[i]).endOf("day").format("X")),li.append($("<span>").text(moment.unix(days[i]).format(this.conf.month.day.format))),$(targetUl).append(li);this.element.find(".calendar-month-events-day").each((function(){$(this).append($("<ul>"))}))},Calendar.prototype.drawCategories=function(){if(this.determineEventsCategories(),this.determineDaynotesCategories(),this.conf.categories.enable){for(var label,div=$("<div>",{class:"calendar-categories"}).css("height","26px"),i=0;i<this.eventCategoryColor.length;i++)(label=$("<span>",{class:"badge badge-default calendar-label"})).css("margin-right","5px"),label.css("background-color",this.eventCategoryColor[i].color),label.css("cursor","pointer"),label.attr("data-color",this.eventCategoryColor[i].color),label.attr("data-clicked",!1),label.text(this.eventCategoryColor[i].category),div.append(label);for(i=0;i<this.daynoteCategoryColor.length;i++)(label=$("<span>",{class:"badge badge-default calendar-label calendar-label-daynote"})).css("margin-right","5px"),label.css("background-color",this.daynoteCategoryColor[i].color),label.css("cursor","pointer"),label.attr("data-color",this.daynoteCategoryColor[i].color),label.attr("data-clicked",!1),label.text(this.daynoteCategoryColor[i].category),div.append(label);this.element.prepend(div),this.hoverCategory(),this.clickCategory()}},Calendar.prototype.hoverCategory=function(){var setTimeoutConst,elem,self=this;this.element.find(".calendar-label").hover((function(){elem=$(this),setTimeoutConst=setTimeout((function(){elem.hasClass("calendar-label-daynote")?$(self.element).trigger("Calendar.category-daynote-mouseenter",[self,elem]):$(self.element).trigger("Calendar.category-event-mouseenter",[self,elem])}),self.conf.categories.hover.delay)}),(function(){clearTimeout(setTimeoutConst),(elem=$(this)).hasClass("calendar-label-daynote")?$(self.element).trigger("Calendar.category-daynote-mouseleave",[self,elem]):$(self.element).trigger("Calendar.category-event-mouseleave",[self,elem])}))},Calendar.prototype.clickCategory=function(){var self=this;this.element.find(".calendar-label").click((function(event){$(event.target).hasClass("calendar-label-daynote")?$(self.element).trigger("Calendar.category-daynote-click",[self,undefined]):$(self.element).trigger("Calendar.category-event-click",[self,undefined])}))},Calendar.prototype.positionEvents=function(){switch(this.getView()){case"day":case"week":this.positionEventsInWeek();break;case"month":this.positionEventsInMonth()}},Calendar.prototype.positionEventsInWeek=function(){var self=this,zeroLast=0;this.element.find(".calendar-event").each((function(i){var start=parseInt($(this).attr("data-start")),duration=parseInt($(this).attr("data-end"))-start,zero=parseInt($(this).closest("li.calendar-events-day").attr("data-time"))+60*self.conf.weekday.timeline.fromHour*60;zero>zeroLast&&(zeroLast=zero);var eventTop=(start-zero)/60/self.conf.weekday.timeline.intervalMinutes*self.conf.weekday.timeline.heightPx-1,eventHeight=duration/60/self.conf.weekday.timeline.intervalMinutes*self.conf.weekday.timeline.heightPx+1,nbEventNotOnCurrent=!1,tmp=[],currentElement=$(this);$(this).closest("ul").find("li.calendar-event").each((function(j,e){$(e)[0]!=currentElement[0]&&(parseInt(currentElement.attr("data-start"))<parseInt($(e).attr("data-end"))&&parseInt(currentElement.attr("data-end"))>parseInt($(e).attr("data-start"))&&(tmp.push($(e))),(parseInt(currentElement.attr("data-start"))<parseInt($(e).attr("data-end"))&&parseInt(currentElement.attr("data-end"))>parseInt($(e).attr("data-end"))||parseInt(currentElement.attr("data-start"))==parseInt($(e).attr("data-start"))&&parseInt($(e).attr("data-index"))<parseInt(currentElement.attr("data-index")))&&0)}));var dates=[];dates.push(parseInt(currentElement.attr("data-start"))),dates.push(parseInt(currentElement.attr("data-end")));for(i=0;i<tmp.length;i++)parseInt(tmp[i].attr("data-start"))>=parseInt(currentElement.attr("data-start"))&&parseInt(tmp[i].attr("data-start"))<=parseInt(currentElement.attr("data-end"))&&dates.push(parseInt(tmp[i].attr("data-start"))),parseInt(tmp[i].attr("data-end"))>=parseInt(currentElement.attr("data-start"))&&parseInt(tmp[i].attr("data-end"))<=parseInt(currentElement.attr("data-end"))&&dates.push(parseInt(tmp[i].attr("data-end")));(dates=self.miscUniqueArray(dates)).sort((function(a,b){return a>b?1:-1}));for(i=0;i<dates.length;i++){for(var enMemeTemps=0,j=0;j<tmp.length;j++)dates[i]>parseInt(tmp[j].attr("data-start"))&&dates[i]<=parseInt(tmp[j].attr("data-end"))&&enMemeTemps++;(enMemeTemps>0&&enMemeTemps>nbEventNotOnCurrent||!1===nbEventNotOnCurrent)&&(nbEventNotOnCurrent=enMemeTemps)}for(currentElement.attr("data-events",nbEventNotOnCurrent+1),currentElement.attr("data-divider",nbEventNotOnCurrent+1),i=tmp.length;i--;)parseInt(tmp[i].attr("data-divider"))>parseInt(currentElement.attr("data-divider"))&&currentElement.attr("data-divider",tmp[i].attr("data-divider"));var positions=[];for(i=0;i<parseInt(currentElement.attr("data-divider"));i++){positions[i]=!1;for(j=0;j<tmp.length;j++)for(var k=0;k<String(tmp[j].attr("data-positions")).split(",").length;k++){String(tmp[j].attr("data-positions")).split(",")[k]==i&&(positions[i]=!0)}}for(currentElement.attr("data-positions",-1),i=0;-1==parseInt(currentElement.attr("data-positions"));){if(!1===positions[i]&&(currentElement.attr("data-positions",i),parseInt(currentElement.attr("data-divider"))-parseInt(currentElement.attr("data-events"))+1>1))for(;!1===positions[i+1];)currentElement.attr("data-positions",currentElement.attr("data-positions")+","+(i+1)),i++;i++}if(!1!==self.conf.rooms)var eventLeft=String(currentElement.attr("data-positions")).split(",")[0]/self.conf.rooms*100,eventWidth=100/self.conf.rooms;else eventWidth=100/(parseInt(currentElement.attr("data-divider"))/String(currentElement.attr("data-positions")).split(",").length),eventLeft=String(currentElement.attr("data-positions")).split(",")[0]/parseInt(currentElement.attr("data-divider"))*100;console.log("###rooms:"+self.conf.rooms),self.setEventPosition(this,eventTop,eventHeight,eventLeft,eventWidth)}))},Calendar.prototype.positionEventsInMonth=function(){var self=this;this.element.find("li.calendar-month-events-day").each((function(){var n=$(this).find(".calendar-event").length;$(this).find(".calendar-event").each((function(i){var eventTop=parseInt($(this).closest(".calendar-month-events-day").index())*self.conf.month.weekline.heightPx+20-1,eventHeight=self.conf.month.weekline.heightPx-21+1,eventWidth=100/n,eventLeft=100/n*i;self.setEventPosition(this,eventTop,eventHeight,eventLeft,eventWidth)}))}))},Calendar.prototype.setEventPosition=function(elem,eventTop,eventHeight,eventLeft,eventWidth){$(elem).attr("data-top",eventTop),$(elem).attr("data-height",eventHeight),$(elem).attr("data-left",eventLeft),$(elem).attr("data-width",eventWidth),$(elem).css({top:eventTop+"px",height:eventHeight+"px",left:eventLeft+"%",width:eventWidth+"%"})},Calendar.prototype.weekDrawEvents=function(){var e,i,day,fromHour,toHour,interval,n=this.events.length;for(i=0;i<n;i++)e=this.events[i],day=!1,fromHour=this.conf.weekday.timeline.fromHour,toHour=this.conf.weekday.timeline.toHour,interval=this.conf.weekday.timeline.intervalMinutes,$(this.element).find(".calendar-events-day").each((function(i,d){e.start>=parseInt($(d).attr("data-time"))+60*fromHour*60&&e.end<=parseInt($(d).attr("data-time"))+60*toHour*60+60/interval*interval*60&&(day=d)})),!1===day||this.drawEventsOrDaynotes(day,i,moment.unix(e.start).format("X"),moment.unix(e.end).format("X"),e.title,e.content,e.category,e.confirmed,e.myevent,this.getEventCategoryColor(e.category),moment.unix(e.start).format(this.conf.weekday.timeline.format)+" - "+moment.unix(e.end).format(this.conf.weekday.timeline.format),["calendar-event"])},Calendar.prototype.weekDrawDaynotes=function(){var i,e,day,n=this.daynotes.length;for(i=0;i<n;i++)if(e=this.daynotes[i],day=!1,$(this.element).find(".calendar-events-day").each((function(m,d){parseInt(moment.unix(e.time).startOf("day").format("X"))==parseInt($(d).attr("data-time"))&&(day=d)})),!1===day);else{this.getDaynoteCategoryColor(e.category);var from=this.conf.weekday.timeline.fromHour,toHour=this.conf.weekday.timeline.toHour+parseInt(this.conf.weekday.timeline.intervalMinutes/60),toMin=60*(this.conf.weekday.timeline.intervalMinutes/60-parseInt(this.conf.weekday.timeline.intervalMinutes/60));this.drawEventsOrDaynotes(day,i,moment.unix(e.time).startOf("day").add(from,"h").format("X"),moment.unix(e.time).startOf("day").add(toHour,"h").add(toMin,"m").format("X"),e.title,e.content,e.category,e.confirmed,e.myevent,this.getDaynoteCategoryColor(e.category),"",["calendar-event","calendar-daynote"])}},Calendar.prototype.drawEventsOrDaynotes=function(e,index,start,end,title,content,category,confirmed,myevent,color,time_interval,classes){for(var li=$("<li>"),i=classes.length;i--;)li.addClass(classes[i]);li.attr("data-index",index),li.attr("data-start",start),li.attr("data-end",end),li.attr("data-title",title),li.attr("data-content",content),li.attr("data-category",category),li.attr("data-confirmed",confirmed),li.attr("data-myevent",myevent),li.attr("data-color",color),li.css("background",color),"1"!==confirmed&&li.css("opacity","0.6"),"1"===myevent&&li.css("border","5px solid darkblue"),a=$("<a>",{href:"#"}),a.append($("<em>",{class:"event-name"}).text(title)),a.append($("<em>",{class:"event-content invisible"})),a.find(".event-content").append($("<b>",{class:"event-date"}).html(time_interval)),a.find(".event-content").append($("<br>")),a.find(".event-content").append(content),li.append(a),$(e).find("ul").append(li)},Calendar.prototype.monthDrawEvents=function(){var i,e,day,n=this.events.length;for(i=0;i<n;i++)e=this.events[i],day=!1,$(this.element).find(".calendar-month-events-day").each((function(m,d){e.start>=parseInt($(d).attr("data-time-from"))&&e.end<=parseInt($(d).attr("data-time-to"))&&(day=d)})),!1===day||this.drawEventsOrDaynotes(day,i,moment.unix(e.start).format("X"),moment.unix(e.end).format("X"),e.title,e.content,e.category,e.confirmed,e.myevent,this.getEventCategoryColor(e.category),moment.unix(e.start).format(this.conf.month.day.format)+" : "+moment.unix(e.start).format(this.conf.weekday.timeline.format)+" - "+moment.unix(e.end).format(this.conf.weekday.timeline.format),["calendar-event"])},Calendar.prototype.monthDrawDaynotes=function(){var i,e,day,n=this.daynotes.length;for(i=0;i<n;i++)e=this.daynotes[i],day=!1,$(this.element).find(".calendar-month-events-day").each((function(m,d){e.time>=parseInt($(d).attr("data-time-from"))&&e.time<=parseInt($(d).attr("data-time-to"))&&(day=d)})),!1===day||this.drawEventsOrDaynotes(day,i,moment.unix(e.time).startOf("day").format("X"),moment.unix(e.time).endOf("day").format("X"),e.title,e.content,e.category,e.confirmed,e.myevent,this.getDaynoteCategoryColor(e.category),moment.unix(e.time).format(this.conf.month.day.format),["calendar-event","calendar-daynote"])},Calendar.prototype.drawModal=function(){modal='<div class="modal fade" id="calendar-modal" tabindex="-1" role="dialog">',modal+='<div class="modal-dialog" role="document">',modal+='<div class="modal-content">',modal+='<div class="modal-header">',modal+='<h3 class="modal-title"></h3>',modal+='<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>',modal+="</div>",modal+='<div class="modal-body">',modal+="</div>",modal+="</div>",modal+="</div>",modal+="</div>",$(this.element).append('<div class="modal fade" id="calendar-modal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h3 class="modal-title"></h3><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"></div></div></div></div>')},Calendar.prototype.drawNow=function(){if(this.conf.now.enable){var hr=$("<hr>",{class:"featurette-divider calendar-now"});hr.css("width","100%"),hr.css("position","absolute"),hr.css("z-index",3),hr.css("border-top",this.conf.now.heightPx+"px "+this.conf.now.style+" "+this.conf.now.color);var top=(moment().format("X")-moment().startOf("day").add(this.conf.weekday.timeline.fromHour,"h").format("X"))/60/this.conf.weekday.timeline.intervalMinutes*this.conf.weekday.timeline.heightPx-this.conf.weekday.timeline.heightPx/2;if(hr.css("top",top+"px"),this.element.find('li.calendar-events-day[data-time="'+moment().startOf("day").format("X")+'"]').find("ul").append(hr),this.conf.now.refresh){var self=this;setInterval((function(){var hr=self.element.find("hr.calendar-now").remove();(hr=$("<hr>",{class:"featurette-divider calendar-now"})).css("width","100%"),hr.css("position","absolute"),hr.css("z-index",2),hr.css("border-top",self.conf.now.heightPx+"px "+self.conf.now.style+" "+self.conf.now.color);var top=(moment().format("X")-moment().startOf("day").add(self.conf.weekday.timeline.fromHour,"h").format("X"))/60/self.conf.weekday.timeline.intervalMinutes*self.conf.weekday.timeline.heightPx-self.conf.weekday.timeline.heightPx/2;hr.css("top",top+"px"),self.element.find('li.calendar-events-day[data-time="'+moment().startOf("day").format("X")+'"]').find("ul").append(hr)}),1e4)}}},Calendar.prototype.hoverEventOrDaynote=function(){var self=this;this.element.find(".calendar-event").each((function(){var setTimeoutConst;$(this).hover((function(){elem=$(this),setTimeoutConst=setTimeout((function(){elem.hasClass("calendar-daynote")?$(self.element).trigger("Calendar.daynote-mouseenter",[self,elem]):$(self.element).trigger("Calendar.event-mouseenter",[self,elem])}),self.conf.event.hover.delay)}),(function(){clearTimeout(setTimeoutConst),elem=$(this),elem.hasClass("calendar-daynote")?$(self.element).trigger("Calendar.daynote-mouseleave",[self,elem]):$(self.element).trigger("Calendar.event-mouseleave",[self,elem])}))}))},Calendar.prototype.clickEventOrDaynote=function(){var self=this;this.element.find(".calendar-event").each((function(){$(this).click((function(event){event.preventDefault(),event.stopPropagation(),elem=$(event.target),"LI"===elem.prop("nodeName")||elem.hasClass("calendar-event")||(elem=elem.closest("li.calendar-event")),elem.hasClass("calendar-daynote")?$(self.element).trigger("Calendar.daynote-click",[self,elem,self.daynotes[parseInt(elem.attr("data-index"))]]):$(self.element).trigger("Calendar.event-click",[self,elem,self.events[parseInt(elem.attr("data-index"))]])}))}))},Calendar.prototype.resizeTimeline=function(){for(var j=this.events.length;j--;)parseInt(moment.unix(this.events[j].start).format("HH"))<this.conf.weekday.timeline.fromHour&&(this.conf.weekday.timeline.fromHour=parseInt(moment.unix(this.events[j].start).format("HH"))),parseInt(this.events[j].end)>parseInt(moment.unix(this.events[j].end).startOf("day").add(this.conf.weekday.timeline.toHour,"hour").format("X"))&&(this.conf.weekday.timeline.toHour=parseInt(moment.unix(this.events[j].end).hour()),this.conf.weekday.timeline.toHour<23&&this.conf.weekday.timeline.toHour++)},Calendar.prototype.getViewDays=function(){var days=[];if("day"==this.getView()&&days.push(parseInt(moment.unix(this.conf.unixTimestamp).format("X"))),"week"==this.getView())for(var i=0;i<this.conf.weekday.dayline.weekdays.length;i++)days.push(parseInt(moment.unix(this.conf.unixTimestamp).startOf("week").add(this.conf.weekday.dayline.weekdays[i],"days").format("X")));if("month"==this.getView()){var nbDaysInMonth=moment.unix(this.conf.unixTimestamp).daysInMonth(),time=moment.unix(this.conf.unixTimestamp).startOf("month");for(i=0;i<nbDaysInMonth;i++)days.push(parseInt(time.startOf("day").format("X"))),time.add(1,"days")}return days},Calendar.prototype.addBtnLeftRight=function(){var self=this;this.element.find(".btn-move-calendar").click((function(event){var elem=$(event.target);"BUTTON"!==elem.prop("nodeName")&&(elem=elem.closest(".btn-move-calendar")),self.moveCurrentIntervalView($(elem).attr("data-direction"))}))},Calendar.prototype.addSwipe=function(){var self=this;self.element.find(".calendar-events").swipe({swipe:function(event,direction){"left"!=direction&&"right"!=direction||("left"==direction?direction="right":"right"==direction&&(direction="left"),self.moveCurrentIntervalView(direction))},threshold:100,allowPageScroll:"auto"})},Calendar.prototype.clickSwitchView=function(){var self=this;$(this.element).find(".monthtoweek").click((function(){self.setTimestamp(parseInt($(this).find("span").attr("data-timestamp"))),self.setView("week"),self.init()})),$(this.element).find(".weektomonth").click((function(){self.setView("month"),self.init()})),$(this.element).find(".daytoweek").click((function(){self.setView("week"),self.init()})),$(this.element).find(".weektoday").click((function(){self.setTimestamp($(this).closest(".calendar-events-day").attr("data-time")),self.setView("day"),self.init()}))},Calendar.prototype.keyboardSwitchView=function(){if(this.conf.enableKeyboard){var self=this;$(window).unbind("keydown").on("keydown",(function(x){37==x.keyCode&&x.ctrlKey&&self.moveCurrentIntervalView("left"),39==x.keyCode&&x.ctrlKey&&self.moveCurrentIntervalView("right"),38==x.keyCode&&x.ctrlKey&&("week"==self.getView()&&(self.setView("month"),self.init()),"day"==self.getView()&&(self.setView("week"),self.init())),40==x.keyCode&&x.ctrlKey&&("week"==self.getView()&&(self.setView("day"),self.init()),"month"==self.getView()&&(self.setView("week"),self.init()))}))}},Calendar.prototype.moveCurrentIntervalView=function(direction){var word;"day"==this.getView()&&(word="days"),"week"==this.getView()&&(word="week"),"month"==this.getView()&&(word="month"),"left"==direction&&(this.conf.unixTimestamp=parseInt(moment.unix(this.conf.unixTimestamp).subtract(1,word).format("X"))),"right"==direction&&(this.conf.unixTimestamp=parseInt(moment.unix(this.conf.unixTimestamp).add(1,word).format("X"))),this.init()},Calendar.prototype.mobileQuery=function(){return $(window).width()<this.conf.defaultView.smallScreenThreshold?"mobile":"desktop"},Calendar.prototype.hexToRgb=function(hex){hex=hex.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(m,r,g,b){return r+r+g+g+b+b}));var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null},Calendar.prototype.calculateCurrentInterval=function(){var days=this.getViewDays();this.fromTimestamp=parseInt(moment.unix(days[0]).startOf("day").format("X")),this.toTimestamp=parseInt(moment.unix(days[days.length-1]).endOf("day").format("X"))},Calendar.prototype.getCategories=function(object,attribute1,attribute2){for(var e,categories=[],n=object.length,fromTimeStamp=parseInt(this.fromTimestamp),toTimeStamp=parseInt(this.toTimestamp),i=0;i<n;i++)e=object[i],parseInt(e[attribute1])>=fromTimeStamp&&parseInt(e[attribute2])<=toTimeStamp&&categories.push(e.category);return this.miscUniqueArray(categories)},Calendar.prototype.getCategoryColor=function(category,object,colors,color){console.log("###category:"+category),console.log("###object:"+JSON.stringify(object,null,4)),console.log("###colors:"+colors),console.log("###color:"+color);var roomcolors=JSON.parse($("#calendar-roomcategories").attr("data-calendar-roomcolors"));console.log("###COLORS:"+JSON.stringify(roomcolors,null,4));for(var used,j,i=roomcolors.length;i--;)if(roomcolors[i].category==category)return object.unshift({category:category,color:roomcolors[i].color}),roomcolors[i].color;for(i=0;i<colors.length;i++){for(used=!1,j=object.length;j--;)object[j].color==colors[i]&&(used=!0);if(!used)return object.push({category:category,color:colors[i]}),colors[i]}return color},Calendar.prototype.getEventsCategories=function(){return this.getCategories(this.events,"start","end")},Calendar.prototype.determineEventsCategories=function(){var categories=this.getEventsCategories();this.eventCategoryColor=this.userEventCategoryColor.length>0?this.userEventCategoryColor:[];for(var i=categories.length;i--;)this.getEventCategoryColor(categories[i])},Calendar.prototype.getEventCategoryColor=function(category){return this.getCategoryColor(category,this.eventCategoryColor,this.conf.colors.events,"#000000")},Calendar.prototype.getEventCategoriesColors=function(){return this.eventCategoryColor},Calendar.prototype.setEventCategoriesColors=function(categoriesColors){this.userEventCategoryColor=categoriesColors},Calendar.prototype.getDaynotesCategories=function(){return this.getCategories(this.daynotes,"time","time")},Calendar.prototype.determineDaynotesCategories=function(){var categories=this.getDaynotesCategories();this.daynoteCategoryColor=this.userDaynoteCategoryColor.length>0?this.userDaynoteCategoryColor:[];for(var i=categories.length;i--;)this.getDaynoteCategoryColor(categories[i])},Calendar.prototype.getDaynoteCategoryColor=function(category){return this.getCategoryColor(category,this.daynoteCategoryColor,this.conf.colors.daynotes,"#FEFEFE")},Calendar.prototype.getDaynoteCategoriesColors=function(){return this.daynoteCategoryColor},Calendar.prototype.setDaynoteCategoriesColors=function(categoriesColors){this.userDaynoteCategoryColor=categoriesColors},Calendar.prototype.getEventColors=function(){return this.conf.colors.events},Calendar.prototype.setEventColors=function(array){this.conf.colors.events=this.miscDedupeArray(array),this.conf.colors.random&&this.conf.colors.events.sort((function(){return.5-Math.random()}))},Calendar.prototype.getDaynoteColors=function(){return this.conf.colors.daynotes},Calendar.prototype.setDaynoteColors=function(array){this.conf.colors.daynotes=this.miscDedupeArray(array),this.conf.colors.random&&this.conf.colors.daynotes.sort((function(){return.5-Math.random()}))},Calendar.prototype.getEvents=function(){return this.events},Calendar.prototype.setEvents=function(events){this.events=events||[],this.events.sort((function(a,b){return a.start>b.start?1:-1}))},Calendar.prototype.addEvents=function(events){this.events=this.events.concat(events),this.events.sort((function(a,b){return a.start>b.start?1:-1}))},Calendar.prototype.getDaynotes=function(){return this.daynotes},Calendar.prototype.setDaynotes=function(daynotes){this.daynotes=daynotes||[],this.daynotes.sort((function(a,b){return a.start>b.start?1:-1}))},Calendar.prototype.addDaynotes=function(daynotes){this.daynotes=this.daynotes.concat(daynotes),this.daynotes.sort((function(a,b){return a.start>b.start?1:-1}))},Calendar.prototype.getInitTime=function(){return this.initTime},Calendar.prototype.getViewInterval=function(){return[this.fromTimestamp,this.toTimestamp]},Calendar.prototype.getNextViewInterval=function(){var add={day:"d",week:"w",month:"M"};return add=add[this.getView()],[parseInt(moment.unix(this.fromTimestamp).add(1,add).format("X")),parseInt(moment.unix(this.toTimestamp).add(1,add).format("X"))]},Calendar.prototype.getPrevViewInterval=function(){var sub={day:"d",week:"w",month:"M"};return sub=sub[this.getView()],[parseInt(moment.unix(this.fromTimestamp).subtract(1,sub).format("X")),parseInt(moment.unix(this.toTimestamp).subtract(1,sub).format("X"))]},Calendar.prototype.getTimestamp=function(){return this.conf.unixTimestamp},Calendar.prototype.setTimestamp=function(timestamp){this.conf.unixTimestamp=parseInt(timestamp)},Calendar.prototype.getView=function(){return this.conf.view},Calendar.prototype.setView=function(view){"day"!=view&&"week"!=view&&"month"!=view||(this.conf.view=view)},Calendar.prototype.miscDedupeArray=function(a){a=a.concat();for(var i=0;i<a.length;++i)for(var j=i+1;j<a.length;++j)a[i]===a[j]&&a.splice(j--,1);return a},Calendar.prototype.miscUniqueArray=function(a){a=a.concat();for(var i=0;i<a.length;++i)for(var j=i+1;j<a.length;++j)a[i]===a[j]&&a.splice(j--,1);return a},Calendar.prototype.miscUcfirstString=function(s){return s.charAt(0).toUpperCase()+s.slice(1)};var resizeListener1,objSchedulesPlan=[];jQuery.extend(jQuery.fn,{Calendar:function(objArgs){var c=new Calendar($(this),void 0===objArgs?{}:objArgs);return objSchedulesPlan.push(c),c}});var resizeListener2;window.addEventListener("orientationchange",(function(){clearTimeout(resizeListener1),resizeListener1=setTimeout((function(){objSchedulesPlan.forEach((function(obj){obj.init()}))}),500)}));window.addEventListener("resize",(function(){clearTimeout(resizeListener2),resizeListener2=setTimeout((function(){objSchedulesPlan.forEach((function(obj){"desktop"==obj.mobileQuery()&&obj.init()}))}),500)}))}));

//# sourceMappingURL=jquery-calendar.min.js.map