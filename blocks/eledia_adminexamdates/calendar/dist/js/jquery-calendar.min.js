jQuery(document).ready(function(b){function d(b,c){if("function"!=typeof moment){console.error("Calendar require Moment.js !");return}var d=["#C62828","#AD1457","#6A1B9A","#4527A0","#283593","#1565C0","#0277BD","#00838F","#00695C","#2E7D32","#558B2F","#9E9D24","#F9A825","#FF8F00","#EF6C00","#D84315","#4E342E","#424242","#37474F","#212121"],e=["#EF9A9A","#F48FB1","#CE93D8","#B39DDB","#9FA8DA","#90CAF9","#81D4FA","#80DEEA","#80CBC4","#A5D6A7","#C5E1A5","#E6EE9C","#FFF59D","#FFE082","#FFCC80","#FFAB91","#BCAAA4","#EEEEEE","#B0BEC5"];this.conf={locale:c.locale?c.locale:"fr",view:"week",enableKeyboard:c.enableKeyboard?c.enableKeyboard:!0,defaultView:{largeScreen:c.defaultView?c.defaultView.largeScreen?c.defaultView.largeScreen:"week":"week",smallScreen:c.defaultView?c.defaultView.smallScreen?c.defaultView.smallScreen:"day":"day",smallScreenThreshold:c.defaultView?c.defaultView.smallScreenThreshold?c.defaultView.smallScreenThreshold:1e3:1e3},weekday:{timeline:{fromHour:c.weekday?c.weekday.timeline?c.weekday.timeline.fromHour?c.weekday.timeline.fromHour:7:7:7,toHour:c.weekday?c.weekday.timeline?c.weekday.timeline.toHour?c.weekday.timeline.toHour:20:20:20,intervalMinutes:c.weekday?c.weekday.timeline?c.weekday.timeline.intervalMinutes?c.weekday.timeline.intervalMinutes:60:60:60,format:c.weekday?c.weekday.timeline?c.weekday.timeline.format?c.weekday.timeline.format:"HH:mm":"HH:mm":"HH:mm",heightPx:c.weekday?c.weekday.timeline?c.weekday.timeline.heightPx?c.weekday.timeline.heightPx:50:50:50,autoResize:c.weekday?c.weekday.timeline?c.weekday.timeline.autoResize!==void 0?c.weekday.timeline.autoResize:!0:!0:!0},dayline:{weekdays:c.weekday?c.weekday.dayline?c.weekday.dayline.weekdays?c.weekday.dayline.weekdays:[0,1,2,3,4,5,6]:[0,1,2,3,4,5,6]:[0,1,2,3,4,5,6],format:c.weekday?c.weekday.dayline?c.weekday.dayline.format?c.weekday.dayline.format:"dddd DD/MM":"dddd DD/MM":"dddd DD/MM",heightPx:c.weekday?c.weekday.dayline?c.weekday.dayline.heightPx?c.weekday.dayline.heightPx?31<c.weekday.dayline.heightPx?c.weekday.dayline.heightPx:31:31:31:31:31,month:{format:c.weekday?c.weekday.dayline?c.weekday.dayline.month?c.weekday.dayline.month.format?c.weekday.dayline.month.format:"MMMM YYYY":"MMMM YYYY":"MMMM YYYY":"MMMM YYYY",heightPx:c.weekday?c.weekday.dayline?c.weekday.dayline.month?c.weekday.dayline.month.heightPx?c.weekday.dayline.month.heightPx:30:30:30:30,weekFormat:c.weekday?c.weekday.dayline?c.weekday.dayline.month?c.weekday.dayline.month.weekFormat?c.weekday.dayline.month.weekFormat:"w":"w":"w":"w"}}},month:{format:c.month?c.month.format?c.month.format:"MMMM YYYY":"MMMM YYYY",heightPx:c.month?c.month.heightPx?31<c.month.heightPx?c.month.heightPx:31:31:31,weekline:{format:c.month?c.month.weekline?c.month.weekline.format?c.month.weekline.format:"w":"w":"w",heightPx:c.month?c.month.weekline?c.month.weekline.heightPx?c.month.weekline.heightPx:80:80:80},dayheader:{weekdays:c.month?c.month.dayheader?c.month.dayheader.weekdays?c.month.dayheader.weekdays:[0,1,2,3,4,5,6]:[0,1,2,3,4,5,6]:[0,1,2,3,4,5,6],format:c.month?c.month.dayheader?c.month.dayheader.format?c.month.dayheader.format:"dddd":"dddd":"dddd",heightPx:c.month?c.month.dayheader?c.month.dayheader.heightPx?c.month.dayheader.heightPx:30:30:30},day:{format:c.month?c.month.day?c.month.day.format?c.month.day.format:"DD/MM":"DD/MM":"DD/MM"}},unixTimestamp:c.unixTimestamp?c.unixTimestamp:moment().format("X"),event:{hover:{delay:c.event?c.event.hover?c.event.hover.delay?c.event.hover.delay:500:500:500}},colors:{events:c.colors?c.colors.events?c.colors.events:d:d,daynotes:c.colors?c.colors.daynotes?c.colors.daynotes:e:e,random:c.colors?c.colors.random?c.colors.random:!0:!0},categories:{enable:c.categories?c.categories.enable!==void 0?c.categories.enable:!0:!0,hover:{delay:c.categories?c.categories.hover?c.categories.hover.delay?c.categories.hover.delay:500:500:500}},now:{enable:c.now?c.now.enable!==void 0?c.now.enable:!1:!1,refresh:c.now?c.now.refresh!==void 0?c.now.refresh:!1:!1,heightPx:c.now?c.now.heightPx?c.now.heightPx:1:1,style:c.now?c.now.style?c.now.style:"solid":"solid",color:c.now?c.now.color?c.now.color:"#03A9F4":"#03A9F4"}};moment.locale(this.conf.locale);this.setEventColors(this.conf.colors.events);this.setDaynoteColors(this.conf.colors.daynotes);this.eventCategoryColor=[];this.daynoteCategoryColor=[];this.userEventCategoryColor=[];this.userDaynoteCategoryColor=[];this.setEvents(c.events?c.events:[]);this.setDaynotes(c.daynotes?c.daynotes:[]);if("mobile"==this.mobileQuery()){this.setView(this.conf.defaultView.smallScreen)}else{this.setView(this.conf.defaultView.largeScreen)}this.element=b;this.initTime=!1}d.prototype.init=function(){var c=Date.now();this.element.addClass("loading");this.calculateCurrentInterval();b(this.element).trigger("Calendar.init",[this,this.getPrevViewInterval(),this.getViewInterval(),this.getNextViewInterval()]);b(this.element).html("");if(!b(this.element).hasClass("calendar")){b(this.element).addClass("calendar")}if("day"==this.getView()||"week"==this.getView()){if(this.conf.weekday.timeline.autoResize){this.resizeTimeline()}}this.drawCategories();if("day"==this.getView()||"week"==this.getView()){this.weekDrawTime();this.weekDrawDays();this.weekDrawDaynotes();this.weekDrawEvents()}if("month"==this.getView()){this.monthDrawWeek();this.monthDrawWeekNumbers();this.monthDrawWeekDays();this.monthDrawDaynotes();this.monthDrawEvents()}this.drawModal();this.drawNow();this.positionEvents();this.hoverEventOrDaynote();this.clickEventOrDaynote();this.addBtnLeftRight();this.addSwipe();this.clickSwitchView();this.keyboardSwitchView();this.defaultEvents();this.element.removeClass("loading");this.initTime=Date.now()-c+"ms"};d.prototype.defaultEvents=function(){if(!0==this.binded){return}var c=this,d=function(b,c,d){if(!b.isDefaultPrevented()){if(parseInt(d.css("top"))>=d.closest("ul").height()/2-c.conf.weekday.timeline.heightPx){var e=parseInt(d.css("top"))+parseInt(d.css("height"));d.css("z-index",10).animate({height:e,top:0,width:"100%",left:0},50)}else{var e=d.closest("ul").height()-parseInt(d.css("top"));d.css("z-index",10).animate({height:e,width:"100%",left:0},50)}d.find(".event-name").removeClass("invisible");d.find(".event-content").removeClass("invisible")}};b(c.element).off("Calendar.event-mouseenter",d).on("Calendar.event-mouseenter",d);b(c.element).off("Calendar.daynote-mouseenter",d).on("Calendar.daynote-mouseenter",d);var e=function(b,c,d){if(!b.isDefaultPrevented()){d.css("z-index","auto").animate({height:parseFloat(d.attr("data-height"))+"px",top:parseFloat(d.attr("data-top")),width:parseFloat(d.attr("data-width"))+"%",left:parseFloat(d.attr("data-left"))+"%"},50);d.find(".event-content").addClass("invisible")}};b(c.element).off("Calendar.event-mouseleave",e).on("Calendar.event-mouseleave",e);b(c.element).off("Calendar.daynote-mouseleave",e).on("Calendar.daynote-mouseleave",e);var f=function(c,d,e){if(!c.isDefaultPrevented()){var f=b(d.element).find("#calendar-modal"),g=d.hexToRgb(e.attr("data-color"));f.css("background","rgba("+g.r+", "+g.g+", "+g.b+", 0.5)");f.find(".modal-title").append(e.attr("data-title")+" ");f.find(".modal-body").append(b("<h4>").append(b(this).closest(".calendar-events-day").find("span").html()).append(" ").append(b("<small>").text(e.find(".event-date").text())));f.find(".modal-body").append(e.find(".event-content").html());f.modal("show");f.on("hidden.bs.modal",function(c){b(c.target).find(".modal-title").html("");b(c.target).find(".modal-body").html("")})}};b(c.element).off("Calendar.event-click",f).on("Calendar.event-click",f);b(c.element).off("Calendar.daynote-click",f).on("Calendar.daynote-click",f);var g=function(c,d,e){if(!c.isDefaultPrevented()){var f=d.element.find(".calendar-event[data-category=\""+b(e).text()+"\"]");if("false"==b(e).attr("data-clicked")){f.animate({opacity:0},200,function(){f.css("display","none");b(e).css("background-color","#E0E0E0");b(e).attr("data-clicked",!0)})}if("true"==b(e).attr("data-clicked")){f.css("display","list-item");b(e).css("background-color",b(e).attr("data-color"));f.animate({opacity:1},200,function(){b(e).attr("data-clicked",!1)})}}};b(c.element).off("Calendar.category-event-click",g).on("Calendar.category-event-click",g);b(c.element).off("Calendar.category-daynote-click",g).on("Calendar.category-daynote-click",g);var h=function(c,d,f){if(!c.isDefaultPrevented()){d.element.find(".calendar-event").each(function(c,d){if(b(d).attr("data-category")!=f.text()){b(d).css("opacity",.2)}})}};b(c.element).off("Calendar.category-event-mouseenter",h).on("Calendar.category-event-mouseenter",h);b(c.element).off("Calendar.category-daynote-mouseenter",h).on("Calendar.category-daynote-mouseenter",h);var i=function(c,d){if(!c.isDefaultPrevented()){d.element.find(".calendar-event").each(function(c,d){b(d).css("opacity",1)})}};b(c.element).off("Calendar.category-event-mouseleave",i).on("Calendar.category-event-mouseleave",i);b(c.element).off("Calendar.category-daynote-mouseleave",i).on("Calendar.category-daynote-mouseleave",i);this.binded=!0};d.prototype.weekDrawTime=function(){b(this.element).append(b("<div>",{class:"calendar-timeline"}));b(this.element).find("div.calendar-timeline").css("padding-top",this.conf.weekday.dayline.heightPx+"px");var c=this.conf.weekday.dayline.month.heightPx;if(this.conf.categories.enable){var d=b(this.element).find("div.calendar-categories");c+=d.height()+parseFloat(d.css("margin-bottom"))}b(this.element).find("div.calendar-timeline").css("margin-top",c+"px");b(this.element).find("div.calendar-timeline").append(b("<ul>"));var e,f=b(this.element).find("div.calendar-timeline").find("ul"),g=moment(moment()).startOf("Week");g.add(this.conf.weekday.timeline.fromHour,"H");var h=(60*(this.conf.weekday.timeline.toHour+1)-60*this.conf.weekday.timeline.fromHour)/this.conf.weekday.timeline.intervalMinutes,j=0;while(j<h){e=b("<li>");e.append(b("<span>").text(g.format(this.conf.weekday.timeline.format)));e.height(this.conf.weekday.timeline.heightPx);f.append(e);g.add(this.conf.weekday.timeline.intervalMinutes,"m");j++}};d.prototype.weekDrawDays=function(){b(this.element).append(b("<div>",{class:"calendar-events"}));var c=b("<div>",{class:"calendar-month"}).css("height",this.conf.weekday.dayline.month.heightPx+"px").css("text-align","center").css("padding-top",(this.conf.weekday.dayline.month.heightPx-20)/2+"px");if("week"==this.getView()){c.text(this.miscUcfirstString(moment.unix(this.conf.unixTimestamp).format(this.conf.weekday.dayline.month.format)));c.addClass("weektomonth")}if("day"==this.getView()){c.text(this.miscUcfirstString(moment.unix(this.conf.unixTimestamp).format(this.conf.weekday.dayline.month.weekFormat)));c.addClass("daytoweek")}b(this.element).find("div.calendar-events").append(c);b(this.element).find("div.calendar-events").append(b("<ul>"));for(var d,e=b(this.element).find("div.calendar-events").find("ul"),f=this.getViewDays(),g=0;g<f.length;g++){time=moment.unix(f[g]);d=b("<li>",{class:"calendar-events-day"});d.css("width",100/f.length+"%");c=b("<div>",{class:"calendar-day-header"});c.height(this.conf.weekday.dayline.heightPx);if(0==g&&"desktop"==this.mobileQuery()){c.append(b("<button>",{class:"btn btn-sm btn-light btn-move-calendar"}).attr("data-direction","left").append(b("<i>",{class:"las la-angle-left"})))}c.append(b("<span>").addClass("weektoday").css("width","100%").html(this.miscUcfirstString(time.format(this.conf.weekday.dayline.format))));if(g==f.length-1&&"desktop"==this.mobileQuery()){c.append(b("<button>",{class:"btn btn-sm btn-light btn-move-calendar"}).attr("data-direction","right").append(b("<i>",{class:"las la-angle-right"})))}d.append(c);d.attr("data-time",time.startOf("day").format("X"));d.append(b("<ul>"));d.find("ul").height(60/this.conf.weekday.timeline.intervalMinutes*(this.conf.weekday.timeline.toHour-this.conf.weekday.timeline.fromHour)*this.conf.weekday.timeline.heightPx+60/this.conf.weekday.timeline.intervalMinutes*this.conf.weekday.timeline.heightPx);e.append(d)}var h=0;b(this.element).find(".calendar-day-header").each(function(){if(b(this).height()>h){h=b(this).height()}});b(this.element).find(".calendar-day-header").each(function(){b(this).height(h)});if(this.conf.weekday.dayline.heightPx<h){this.conf.weekday.dayline.heightPx=h;b(this.element).find("div.calendar-timeline").css("padding-top",this.conf.weekday.dayline.heightPx+"px")}};d.prototype.monthDrawWeek=function(){b(this.element).append(b("<div>",{class:"calendar-events"}));var c=b("<div>",{class:"calendar-month"});c.css("height",this.conf.month.heightPx+"px");if("desktop"==this.mobileQuery()){c.append(b("<button>",{class:"btn btn-sm btn-light btn-move-calendar"}).attr("data-direction","left").append(b("<i>",{class:"las la-angle-left"})))}c.append(b("<span>").css("position","absolute").css("top",this.conf.month.heightPx/2+"px").css("right","50%").css("transform","translate(50%,-50%)").text(this.miscUcfirstString(moment.unix(this.conf.unixTimestamp).format(this.conf.month.format))));if("desktop"==this.mobileQuery()){c.append(b("<button>",{class:"btn btn-sm btn-light btn-move-calendar"}).css("float","right").attr("data-direction","right").append(b("<i>",{class:"las la-angle-right"})))}b(this.element).find("div.calendar-events").append(c);b(this.element).find("div.calendar-events").append(b("<ul>"));var d,e=b(this.element).find("div.calendar-events").find("ul"),f=moment.unix(this.conf.unixTimestamp).startOf("month"),g=parseInt(f.format("MM")),h=parseInt(f.format("w")),j=0;while(parseInt(f.format("MM"))==g){j++;while(parseInt(f.format("w"))==h){f.add(1,"days")}h=parseInt(f.format("w"))}for(var k=0;k<this.conf.month.dayheader.weekdays.length;k++){f=moment().startOf("week").add(this.conf.month.dayheader.weekdays[k],"days");d=b("<li>",{class:"calendar-month-day-header"});d.append(b("<div>").css("height",this.conf.month.dayheader.heightPx+"px").css("padding-top",(this.conf.month.dayheader.heightPx-20)/2+"px").text(this.miscUcfirstString(f.format(this.conf.month.dayheader.format))));d.css("width",100/this.conf.month.dayheader.weekdays.length+"%");d.append(b("<ul>").css("height",j*this.conf.month.weekline.heightPx+"px"));e.append(d)}var l=0;b(this.element).find(".calendar-month-day-header").each(function(){var c=b(this).find("div");if(b(c).height()>l){l=b(c).height()}});b(this.element).find(".calendar-month-day-header").each(function(){var c=b(this).find("div");b(c).height(l)})};d.prototype.monthDrawWeekNumbers=function(){b(this.element).append(b("<div>",{class:"calendar-timeline"}));var c=this.conf.month.dayheader.heightPx;c+=this.conf.month.heightPx;if(this.conf.categories.enable){c+=30}c+=2;b(this.element).find("div.calendar-timeline").css("margin-top",c+"px");b(this.element).find("div.calendar-timeline").append(b("<ul>"));var d,e=b(this.element).find("div.calendar-timeline").find("ul"),f=moment.unix(this.conf.unixTimestamp).startOf("month"),g=parseInt(f.format("MM")),h=parseInt(f.format("w"));while(parseInt(f.format("MM"))==g){d=b("<li>",{class:"monthtoweek"});d.append(b("<span>").attr("data-timestamp",f.format("X")).text(f.format(this.conf.month.weekline.format)).css("margin-top",this.conf.month.weekline.heightPx/2+"px"));d.height(this.conf.month.weekline.heightPx);e.append(d);while(parseInt(f.format("w"))==h){f.add(1,"days")}h=parseInt(f.format("w"))}};d.prototype.monthDrawWeekDays=function(){var c=this.getViewDays(),d,e,f=parseInt(moment.unix(c[0]).weekday()),g=moment.unix(c[0]);while(0<f){g=g.subtract(1,"days");d=this.element.find(".calendar-events>ul>.calendar-month-day-header>div:contains('"+this.miscUcfirstString(g.format(this.conf.month.dayheader.format))+"')").parent().find("ul");e=b("<li>");e.css("height",this.conf.month.weekline.heightPx+"px");b(d).append(e);f--}g=c.length;for(f=0;f<g;f++){d=this.element.find(".calendar-events>ul>.calendar-month-day-header>div:contains('"+this.miscUcfirstString(moment.unix(c[f]).format(this.conf.month.dayheader.format))+"')").parent().find("ul");e=b("<li>",{class:"calendar-month-events-day"});e.css("height",this.conf.month.weekline.heightPx+"px");e.attr("data-time-from",moment.unix(c[f]).startOf("day").format("X"));e.attr("data-time-to",moment.unix(c[f]).endOf("day").format("X"));e.append(b("<span>").text(moment.unix(c[f]).format(this.conf.month.day.format)));b(d).append(e)}this.element.find(".calendar-month-events-day").each(function(){b(this).append(b("<ul>"))})};d.prototype.drawCategories=function(){this.determineEventsCategories();this.determineDaynotesCategories();if(this.conf.categories.enable){for(var c,d=b("<div>",{class:"calendar-categories"}).css("height","26px"),e=0;e<this.eventCategoryColor.length;e++){c=b("<span>",{class:"badge badge-default calendar-label"});c.css("margin-right","5px");c.css("background-color",this.eventCategoryColor[e].color);c.css("cursor","pointer");c.attr("data-color",this.eventCategoryColor[e].color);c.attr("data-clicked",!1);c.text(this.eventCategoryColor[e].category);d.append(c)}for(e=0;e<this.daynoteCategoryColor.length;e++){c=b("<span>",{class:"badge badge-default calendar-label calendar-label-daynote"});c.css("margin-right","5px");c.css("background-color",this.daynoteCategoryColor[e].color);c.css("cursor","pointer");c.attr("data-color",this.daynoteCategoryColor[e].color);c.attr("data-clicked",!1);c.text(this.daynoteCategoryColor[e].category);d.append(c)}this.element.prepend(d);this.hoverCategory();this.clickCategory()}};d.prototype.hoverCategory=function(){var c,d,e=this;this.element.find(".calendar-label").hover(function(){d=b(this);c=setTimeout(function(){if(d.hasClass("calendar-label-daynote")){b(e.element).trigger("Calendar.category-daynote-mouseenter",[e,d])}else{b(e.element).trigger("Calendar.category-event-mouseenter",[e,d])}},e.conf.categories.hover.delay)},function(){clearTimeout(c);d=b(this);if(d.hasClass("calendar-label-daynote")){b(e.element).trigger("Calendar.category-daynote-mouseleave",[e,d])}else{b(e.element).trigger("Calendar.category-event-mouseleave",[e,d])}})};d.prototype.clickCategory=function(){var c,d=this;this.element.find(".calendar-label").click(function(e){if(b(e.target).hasClass("calendar-label-daynote")){b(d.element).trigger("Calendar.category-daynote-click",[d,c])}else{b(d.element).trigger("Calendar.category-event-click",[d,c])}})};d.prototype.positionEvents=function(){switch(this.getView()){case"day":case"week":this.positionEventsInWeek();break;case"month":this.positionEventsInMonth();break;}};d.prototype.positionEventsInWeek=function(){var c=this,d=0;this.element.find(".calendar-event").each(function(e){var f=parseInt(b(this).attr("data-start")),g=parseInt(b(this).attr("data-end")),h=parseInt(b(this).closest("li.calendar-events-day").attr("data-time"))+60*(60*c.conf.weekday.timeline.fromHour);if(h>d){d=h}var l=(f-h)/60/c.conf.weekday.timeline.intervalMinutes*c.conf.weekday.timeline.heightPx-1,m=(g-f)/60/c.conf.weekday.timeline.intervalMinutes*c.conf.weekday.timeline.heightPx+1,n=0,o=!1,p=0,q=[],r=b(this);b(this).closest("ul").find("li.calendar-event").each(function(c,d){if(b(d)[0]!=r[0]){if(parseInt(r.attr("data-start"))<parseInt(b(d).attr("data-end"))&&parseInt(r.attr("data-end"))>parseInt(b(d).attr("data-start"))){q.push(b(d));p++}if(parseInt(r.attr("data-start"))<parseInt(b(d).attr("data-end"))&&parseInt(r.attr("data-end"))>parseInt(b(d).attr("data-end"))){n++}else if(parseInt(r.attr("data-start"))==parseInt(b(d).attr("data-start"))&&parseInt(b(d).attr("data-index"))<parseInt(r.attr("data-index"))){n++}}});for(var s=[parseInt(r.attr("data-start")),parseInt(r.attr("data-end"))],e=0;e<q.length;e++){if(parseInt(q[e].attr("data-start"))>=parseInt(r.attr("data-start"))&&parseInt(q[e].attr("data-start"))<=parseInt(r.attr("data-end"))){s.push(parseInt(q[e].attr("data-start")))}if(parseInt(q[e].attr("data-end"))>=parseInt(r.attr("data-start"))&&parseInt(q[e].attr("data-end"))<=parseInt(r.attr("data-end"))){s.push(parseInt(q[e].attr("data-end")))}}s=c.miscUniqueArray(s);s.sort(function(c,d){return c>d?1:-1});for(var e=0,t;e<s.length;e++){t=0;for(var u=0;u<q.length;u++){if(s[e]>parseInt(q[u].attr("data-start"))&&s[e]<=parseInt(q[u].attr("data-end"))){t++}}if(0<t&&t>o||!1===o){o=t}}r.attr("data-events",o+1);r.attr("data-divider",o+1);e=q.length;while(e--){if(parseInt(q[e].attr("data-divider"))>parseInt(r.attr("data-divider"))){r.attr("data-divider",q[e].attr("data-divider"))}}var v=[];for(e=0;e<parseInt(r.attr("data-divider"));e++){v[e]=!1;for(var u=0;u<q.length;u++){for(var w=0,x;w<(q[u].attr("data-positions")+"").split(",").length;w++){x=(q[u].attr("data-positions")+"").split(",")[w];if(x==e){v[e]=!0}}}}r.attr("data-positions",-1);e=0;while(-1==parseInt(r.attr("data-positions"))){if(!1===v[e]){r.attr("data-positions",e);if(1<parseInt(r.attr("data-divider"))-parseInt(r.attr("data-events"))+1){while(!1===v[e+1]){r.attr("data-positions",r.attr("data-positions")+","+(e+1));e++}}}e++}var y=100/(parseInt(r.attr("data-divider"))/(r.attr("data-positions")+"").split(",").length),z=100*((r.attr("data-positions")+"").split(",")[0]/parseInt(r.attr("data-divider")));c.setEventPosition(this,l,m,z,y)})};d.prototype.positionEventsInMonth=function(){var c=this;this.element.find("li.calendar-month-events-day").each(function(){var d=b(this).find(".calendar-event").length;b(this).find(".calendar-event").each(function(e){var f=parseInt(b(this).closest(".calendar-month-events-day").index())*c.conf.month.weekline.heightPx+20-1,g=c.conf.month.weekline.heightPx-21+1;c.setEventPosition(this,f,g,100/d*e,100/d)})})};d.prototype.setEventPosition=function(c,d,e,f,g){b(c).attr("data-top",d);b(c).attr("data-height",e);b(c).attr("data-left",f);b(c).attr("data-width",g);b(c).css({top:d+"px",height:e+"px",left:f+"%",width:g+"%"})};d.prototype.weekDrawEvents=function(){var c,d,f,g,h,j,k=this.events.length;for(d=0;d<k;d++){c=this.events[d];f=!1;g=this.conf.weekday.timeline.fromHour;h=this.conf.weekday.timeline.toHour;j=this.conf.weekday.timeline.intervalMinutes;b(this.element).find(".calendar-events-day").each(function(e,i){if(c.start>=parseInt(b(i).attr("data-time"))+60*(60*g)&&c.end<=parseInt(b(i).attr("data-time"))+60*(60*h)+60*(60/j*j)){f=i}});if(!(!1===f)){this.drawEventsOrDaynotes(f,d,moment.unix(c.start).format("X"),moment.unix(c.end).format("X"),c.title,c.content,c.category,this.getEventCategoryColor(c.category),moment.unix(c.start).format(this.conf.weekday.timeline.format)+" - "+moment.unix(c.end).format(this.conf.weekday.timeline.format),["calendar-event"])}}};d.prototype.weekDrawDaynotes=function(){var c,f,g,h=this.daynotes.length;for(c=0;c<h;c++){f=this.daynotes[c];g=!1;b(this.element).find(".calendar-events-day").each(function(c,e){if(parseInt(moment.unix(f.time).startOf("day").format("X"))==parseInt(b(e).attr("data-time"))){g=e}});if(!(!1===g)){var d=this.getDaynoteCategoryColor(f.category),j=this.conf.weekday.timeline.fromHour,k=this.conf.weekday.timeline.toHour+parseInt(this.conf.weekday.timeline.intervalMinutes/60),l=60*(this.conf.weekday.timeline.intervalMinutes/60-parseInt(this.conf.weekday.timeline.intervalMinutes/60));this.drawEventsOrDaynotes(g,c,moment.unix(f.time).startOf("day").add(j,"h").format("X"),moment.unix(f.time).startOf("day").add(k,"h").add(l,"m").format("X"),f.title,f.content,f.category,this.getDaynoteCategoryColor(f.category),"",["calendar-event","calendar-daynote"])}}};d.prototype.drawEventsOrDaynotes=function(c,d,e,f,g,h,j,k,l,m){var n=b("<li>"),o=m.length;while(o--){n.addClass(m[o])}n.attr("data-index",d);n.attr("data-start",e);n.attr("data-end",f);n.attr("data-title",g);n.attr("data-content",h);n.attr("data-category",j);n.attr("data-color",k);n.css("background",k);a=b("<a>",{href:"#"});a.append(b("<em>",{class:"event-name"}).text(g));a.append(b("<em>",{class:"event-content invisible"}));a.find(".event-content").append(b("<b>",{class:"event-date"}).html(l));a.find(".event-content").append(b("<br>"));a.find(".event-content").append(h);n.append(a);b(c).find("ul").append(n)};d.prototype.monthDrawEvents=function(){var c,f,g,h=this.events.length;for(c=0;c<h;c++){f=this.events[c];g=!1;b(this.element).find(".calendar-month-events-day").each(function(c,e){if(f.start>=parseInt(b(e).attr("data-time-from"))&&f.end<=parseInt(b(e).attr("data-time-to"))){g=e}});if(!(!1===g)){this.drawEventsOrDaynotes(g,c,moment.unix(f.start).format("X"),moment.unix(f.end).format("X"),f.title,f.content,f.category,this.getEventCategoryColor(f.category),moment.unix(f.start).format(this.conf.month.day.format)+" : "+moment.unix(f.start).format(this.conf.weekday.timeline.format)+" - "+moment.unix(f.end).format(this.conf.weekday.timeline.format),["calendar-event"])}}};d.prototype.monthDrawDaynotes=function(){var c,f,g,h=this.daynotes.length;for(c=0;c<h;c++){f=this.daynotes[c];g=!1;b(this.element).find(".calendar-month-events-day").each(function(c,e){if(f.time>=parseInt(b(e).attr("data-time-from"))&&f.time<=parseInt(b(e).attr("data-time-to"))){g=e}});if(!(!1===g)){this.drawEventsOrDaynotes(g,c,moment.unix(f.time).startOf("day").format("X"),moment.unix(f.time).endOf("day").format("X"),f.title,f.content,f.category,this.getDaynoteCategoryColor(f.category),moment.unix(f.time).format(this.conf.month.day.format),["calendar-event","calendar-daynote"])}}};d.prototype.drawModal=function(){modal="<div class=\"modal fade\" id=\"calendar-modal\" tabindex=\"-1\" role=\"dialog\">";modal+="<div class=\"modal-dialog\" role=\"document\">";modal+="<div class=\"modal-content\">";modal+="<div class=\"modal-header\">";modal+="<h3 class=\"modal-title\"></h3>";modal+="<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>";modal+="</div>";modal+="<div class=\"modal-body\">";modal+="</div>";modal+="</div>";modal+="</div>";modal+="</div>";b(this.element).append(modal)};d.prototype.drawNow=function(){if(this.conf.now.enable){var c=b("<hr>",{class:"featurette-divider calendar-now"});c.css("width","100%");c.css("position","absolute");c.css("z-index",3);c.css("border-top",this.conf.now.heightPx+"px "+this.conf.now.style+" "+this.conf.now.color);var d=(moment().format("X")-moment().startOf("day").add(this.conf.weekday.timeline.fromHour,"h").format("X"))/60/this.conf.weekday.timeline.intervalMinutes*this.conf.weekday.timeline.heightPx-this.conf.weekday.timeline.heightPx/2;c.css("top",d+"px");this.element.find("li.calendar-events-day[data-time=\""+moment().startOf("day").format("X")+"\"]").find("ul").append(c);if(this.conf.now.refresh){var e=this;setInterval(function(){var c=e.element.find("hr.calendar-now").remove(),c=b("<hr>",{class:"featurette-divider calendar-now"});c.css("width","100%");c.css("position","absolute");c.css("z-index",2);c.css("border-top",e.conf.now.heightPx+"px "+e.conf.now.style+" "+e.conf.now.color);var d=(moment().format("X")-moment().startOf("day").add(e.conf.weekday.timeline.fromHour,"h").format("X"))/60/e.conf.weekday.timeline.intervalMinutes*e.conf.weekday.timeline.heightPx-e.conf.weekday.timeline.heightPx/2;c.css("top",d+"px");e.element.find("li.calendar-events-day[data-time=\""+moment().startOf("day").format("X")+"\"]").find("ul").append(c)},1e4)}}};d.prototype.hoverEventOrDaynote=function(){var c=this;this.element.find(".calendar-event").each(function(){var d;b(this).hover(function(){elem=b(this);d=setTimeout(function(){if(elem.hasClass("calendar-daynote")){b(c.element).trigger("Calendar.daynote-mouseenter",[c,elem])}else{b(c.element).trigger("Calendar.event-mouseenter",[c,elem])}},c.conf.event.hover.delay)},function(){clearTimeout(d);elem=b(this);if(elem.hasClass("calendar-daynote")){b(c.element).trigger("Calendar.daynote-mouseleave",[c,elem])}else{b(c.element).trigger("Calendar.event-mouseleave",[c,elem])}})})};d.prototype.clickEventOrDaynote=function(){var c=this;this.element.find(".calendar-event").each(function(){b(this).click(function(d){elem=b(d.target);if("LI"!==elem.prop("nodeName")&&!elem.hasClass("calendar-event")){elem=elem.closest("li.calendar-event")}if(elem.hasClass("calendar-daynote")){b(c.element).trigger("Calendar.daynote-click",[c,elem,c.daynotes[parseInt(elem.attr("data-index"))]])}else{b(c.element).trigger("Calendar.event-click",[c,elem,c.events[parseInt(elem.attr("data-index"))]])}})})};d.prototype.resizeTimeline=function(){var b=this.events.length;while(b--){if(parseInt(moment.unix(this.events[b].start).format("HH"))<this.conf.weekday.timeline.fromHour){this.conf.weekday.timeline.fromHour=parseInt(moment.unix(this.events[b].start).format("HH"))}if(parseInt(this.events[b].end)>parseInt(moment.unix(this.events[b].end).startOf("day").add(this.conf.weekday.timeline.toHour,"hour").format("X"))){this.conf.weekday.timeline.toHour=parseInt(moment.unix(this.events[b].end).hour());if(23>this.conf.weekday.timeline.toHour){this.conf.weekday.timeline.toHour++}}}};d.prototype.getViewDays=function(){var b=[];if("day"==this.getView()){b.push(parseInt(moment.unix(this.conf.unixTimestamp).format("X")))}if("week"==this.getView()){for(var c=0;c<this.conf.weekday.dayline.weekdays.length;c++){b.push(parseInt(moment.unix(this.conf.unixTimestamp).startOf("week").add(this.conf.weekday.dayline.weekdays[c],"days").format("X")))}}if("month"==this.getView()){for(var d=moment.unix(this.conf.unixTimestamp).daysInMonth(),e=moment.unix(this.conf.unixTimestamp).startOf("month"),c=0;c<d;c++){b.push(parseInt(e.startOf("day").format("X")));e.add(1,"days")}}return b};d.prototype.addBtnLeftRight=function(){var c=this;this.element.find(".btn-move-calendar").click(function(d){var e=b(d.target);if("BUTTON"!==e.prop("nodeName")){e=e.closest(".btn-move-calendar")}c.moveCurrentIntervalView(b(e).attr("data-direction"))})};d.prototype.addSwipe=function(){var b=this;b.element.find(".calendar-events").swipe({swipe:function swipe(c,d){if("left"==d||"right"==d){if("left"==d){d="right"}else if("right"==d){d="left"}b.moveCurrentIntervalView(d)}},threshold:100,allowPageScroll:"auto"})};d.prototype.clickSwitchView=function(){var c=this;b(this.element).find(".monthtoweek").click(function(){c.setTimestamp(parseInt(b(this).find("span").attr("data-timestamp")));c.setView("week");c.init()});b(this.element).find(".weektomonth").click(function(){c.setView("month");c.init()});b(this.element).find(".daytoweek").click(function(){c.setView("week");c.init()});b(this.element).find(".weektoday").click(function(){c.setTimestamp(b(this).closest(".calendar-events-day").attr("data-time"));c.setView("day");c.init()})};d.prototype.keyboardSwitchView=function(){if(!this.conf.enableKeyboard){return}var c=this;b(window).unbind("keydown").on("keydown",function(b){if(37==b.keyCode&&b.ctrlKey){c.moveCurrentIntervalView("left")}if(39==b.keyCode&&b.ctrlKey){c.moveCurrentIntervalView("right")}if(38==b.keyCode&&b.ctrlKey){if("week"==c.getView()){c.setView("month");c.init()}if("day"==c.getView()){c.setView("week");c.init()}}if(40==b.keyCode&&b.ctrlKey){if("week"==c.getView()){c.setView("day");c.init()}if("month"==c.getView()){c.setView("week");c.init()}}})};d.prototype.moveCurrentIntervalView=function(b){var c,d=this;if("day"==this.getView()){c="days"}if("week"==this.getView()){c="week"}if("month"==this.getView()){c="month"}if("left"==b){this.conf.unixTimestamp=parseInt(moment.unix(d.conf.unixTimestamp).subtract(1,c).format("X"))}if("right"==b){this.conf.unixTimestamp=parseInt(moment.unix(d.conf.unixTimestamp).add(1,c).format("X"))}this.init()};d.prototype.mobileQuery=function(){return b(window).width()<this.conf.defaultView.smallScreenThreshold?"mobile":"desktop"};d.prototype.hexToRgb=function(b){b=b.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(c,d,e,f){return d+d+e+e+f+f});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return c?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null};d.prototype.calculateCurrentInterval=function(){var b=this.getViewDays();this.fromTimestamp=parseInt(moment.unix(b[0]).startOf("day").format("X"));this.toTimestamp=parseInt(moment.unix(b[b.length-1]).endOf("day").format("X"))};d.prototype.getCategories=function(b,c,d){for(var f=[],g,h=b.length,j=parseInt(this.fromTimestamp),k=parseInt(this.toTimestamp),l=0;l<h;l++){g=b[l];if(parseInt(g[c])>=j&&parseInt(g[d])<=k){f.push(g.category)}}return this.miscUniqueArray(f)};d.prototype.getCategoryColor=function(c,d,e,f){console.log("###category:"+c);console.log("###object:"+JSON.stringify(d,null,4));console.log("###colors:"+e);console.log("###color:"+f);var g=JSON.parse(b("#calendar-roomcategories").attr("data-calendar-roomcolors"));console.log("###COLORS:"+JSON.stringify(g,null,4));var h,k,l=g.length;while(l--){if(g[l].category==c){d.push({category:c,color:g[l].color});return g[l].color}}for(l=0;l<e.length;l++){h=!1;k=d.length;while(k--){if(d[k].color==e[l]){h=!0}}if(!h){d.push({category:c,color:e[l]});return e[l]}}return f};d.prototype.getEventsCategories=function(){return this.getCategories(this.events,"start","end")};d.prototype.determineEventsCategories=function(){var b=this.getEventsCategories();this.eventCategoryColor=0<this.userEventCategoryColor.length?this.userEventCategoryColor:[];var c=b.length;while(c--){this.getEventCategoryColor(b[c])}};d.prototype.getEventCategoryColor=function(b){return this.getCategoryColor(b,this.eventCategoryColor,this.conf.colors.events,"#000000")};d.prototype.getEventCategoriesColors=function(){return this.eventCategoryColor};d.prototype.setEventCategoriesColors=function(b){this.userEventCategoryColor=b};d.prototype.getDaynotesCategories=function(){return this.getCategories(this.daynotes,"time","time")};d.prototype.determineDaynotesCategories=function(){var b=this.getDaynotesCategories();this.daynoteCategoryColor=0<this.userDaynoteCategoryColor.length?this.userDaynoteCategoryColor:[];var c=b.length;while(c--){this.getDaynoteCategoryColor(b[c])}};d.prototype.getDaynoteCategoryColor=function(b){return this.getCategoryColor(b,this.daynoteCategoryColor,this.conf.colors.daynotes,"#FEFEFE")};d.prototype.getDaynoteCategoriesColors=function(){return this.daynoteCategoryColor};d.prototype.setDaynoteCategoriesColors=function(b){this.userDaynoteCategoryColor=b};d.prototype.getEventColors=function(){return this.conf.colors.events};d.prototype.setEventColors=function(b){this.conf.colors.events=this.miscDedupeArray(b);if(this.conf.colors.random){this.conf.colors.events.sort(function(){return .5-Math.random()})}};d.prototype.getDaynoteColors=function(){return this.conf.colors.daynotes};d.prototype.setDaynoteColors=function(b){this.conf.colors.daynotes=this.miscDedupeArray(b);if(this.conf.colors.random){this.conf.colors.daynotes.sort(function(){return .5-Math.random()})}};d.prototype.getEvents=function(){return this.events};d.prototype.setEvents=function(b){this.events=b?b:[];this.events.sort(function(c,d){return c.start>d.start?1:-1})};d.prototype.addEvents=function(b){this.events=this.events.concat(b);this.events.sort(function(c,d){return c.start>d.start?1:-1})};d.prototype.getDaynotes=function(){return this.daynotes};d.prototype.setDaynotes=function(b){this.daynotes=b?b:[];this.daynotes.sort(function(c,d){return c.start>d.start?1:-1})};d.prototype.addDaynotes=function(b){this.daynotes=this.daynotes.concat(b);this.daynotes.sort(function(c,d){return c.start>d.start?1:-1})};d.prototype.getInitTime=function(){return this.initTime};d.prototype.getViewInterval=function(){return[this.fromTimestamp,this.toTimestamp]};d.prototype.getNextViewInterval=function(){var b={day:"d",week:"w",month:"M"};b=b[this.getView()];return[parseInt(moment.unix(this.fromTimestamp).add(1,b).format("X")),parseInt(moment.unix(this.toTimestamp).add(1,b).format("X"))]};d.prototype.getPrevViewInterval=function(){var b={day:"d",week:"w",month:"M"};b=b[this.getView()];return[parseInt(moment.unix(this.fromTimestamp).subtract(1,b).format("X")),parseInt(moment.unix(this.toTimestamp).subtract(1,b).format("X"))]};d.prototype.getTimestamp=function(){return this.conf.unixTimestamp};d.prototype.setTimestamp=function(b){this.conf.unixTimestamp=parseInt(b)};d.prototype.getView=function(){return this.conf.view};d.prototype.setView=function(b){if("day"==b||"week"==b||"month"==b){this.conf.view=b}};d.prototype.miscDedupeArray=function(b){b=b.concat();for(var c=0;c<b.length;++c){for(var d=c+1;d<b.length;++d){if(b[c]===b[d]){b.splice(d--,1)}}}return b};d.prototype.miscUniqueArray=function(b){b=b.concat();for(var c=0;c<b.length;++c){for(var d=c+1;d<b.length;++d){if(b[c]===b[d]){b.splice(d--,1)}}}return b};d.prototype.miscUcfirstString=function(b){return b.charAt(0).toUpperCase()+b.slice(1)};var e=[];jQuery.extend(jQuery.fn,{Calendar:function Calendar(f){var g=new d(b(this),f===void 0?{}:f);e.push(g);return g}});var f;window.addEventListener("orientationchange",function(){clearTimeout(f);f=setTimeout(function(){e.forEach(function(b){b.init()})},500)});var g;window.addEventListener("resize",function(){clearTimeout(g);g=setTimeout(function(){e.forEach(function(b){if("desktop"==b.mobileQuery()){b.init()}})},500)})});
//# sourceMappingURL=jquery-calendar.min.js.map
